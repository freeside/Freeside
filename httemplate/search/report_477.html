<% include('/elements/header.html', 'FCC Form 477 Report' ) %>

<FORM ACTION="477.html" METHOD="GET">
<INPUT TYPE="hidden" NAME="magic" VALUE="active">

  <TABLE BGCOLOR="#cccccc" CELLSPACING=0>

    <TR>
      <TH CLASS="background" COLSPAN=2 ALIGN="left">
        <FONT SIZE="+1">Search options</FONT>
      </TH>
    </TR>

    <% include( '/elements/tr-select-agent.html',
                   'curr_value'    => scalar( $cgi->param('agentnum') ),
                   'disable_empty' => 0,
               )
    %>

    <% include( '/elements/tr-select-pkg_class.html',
                   'pre_options' => [ '0' => 'all' ],
                   'empty_label' => '(empty class)',
               )
    %>

%   if ( scalar( qsearch( 'part_pkg_report_option', { 'disabled' => '' } ) ) ) {
%   # the m2 javascript magic in edit/elements/edit.html would be better here

    <% include( '/elements/tr-select-table.html',
                   'label'        => 'Column report classes',
                   'table'        => 'part_pkg_report_option',
                   'name_col'     => 'name',
                   'hashref'      => { 'disabled' => '' },
                   'element_name' => 'column_option',
                   'multiple'     => 'multiple',
               )
    %>

    <% include( '/elements/tr-select-table.html',
                   'label'        => 'Row report classes',
                   'table'        => 'part_pkg_report_option',
                   'name_col'     => 'name',
                   'hashref'      => { 'disabled' => '' },
                   'element_name' => 'row_option',
                   'multiple'     => 'multiple',
               )
    %>

%   }

  </TABLE>

<BR>
<INPUT TYPE="submit" VALUE="Get Report">

</FORM>

<% include('/elements/footer.html') %>
<%init>

die "access denied"
  unless $FS::CurrentUser::CurrentUser->access_right('List packages');

</%init>
