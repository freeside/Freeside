<& /elements/header.html, mt('Google Authenticator for [_1]', $FS::CurrentUser::CurrentUser->username) &>

Scan this code with the Google Authenticator application on your phone.
<BR><BR>

<IMG SRC="<% $access_user->totp_qr_code_url %>"></IMG>
<BR><BR>

Future logins will require a 6-digit code generated by the application.

<& /elements/footer.html &>
<%init>

my $access_user = $FS::CurrentUser::CurrentUser;

my $error = $access_user->set_totp_secret32 unless length($access_user->totp_secret32);
die $error if $error; #better error handling for this "shouldn't happen" case?

</%init>
